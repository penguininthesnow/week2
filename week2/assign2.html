<!-- 作業一 -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>work-1 作業一</title>
</head>
<body>
    <script>
    const positions = {  // 角色定義座標
    "悟空": [0, 0],
    "丁滿":[-1, 4],
    "辛巴":[-3, 3],
    "貝吉塔":[-4, -1],
    "弗利沙":[4, -1],
    "特南克斯":[1, -2],

}

// 定義斜線: y=-x+2
const P1 = [-4, 6]  // 在線的左上
const P2 = [6, -4]  // 在線的右下


// 先判斷在線的哪一側(兩點式)
function lineSide(p){
    const [x, y] = p ;
    const [x1, y1] = P1 ;
    const [x2, y2] = P2 ;
    return (y2-y1)*(x-x1)-(x2-x1)*(y-y1);
}
    
    
// 判斷是否跨越邊界線
function isCrossLine(p1, p2){
    return lineSide(p1)*lineSide(p2)<0
}

// 計算曼哈頓距離( 若有跨越則+2 )
function calcDistance(p1, p2){
    const dx= Math.abs(p1[0]-p2[0]);
    const dy= Math.abs(p1[1]-p2[1]);
    let d =dx+dy;
    if(isCrossLine(p1, p2)){
        d+=2;
    }
    return d;
}

// 主函式:找最遠、最近
function func1(name){
    if(!positions[name]) {
        console.log("角色不存在");
        return;
    }

const target=positions[name];
const dists={};

for (const[other, pos] of Object.entries(positions)) {
    if(other===name) continue;
    dists[other]=calcDistance(target, pos);
}

const values=Object.values(dists);
const min=Math.min(...values);
const max=Math.max(...values);

const nearest = Object.keys(dists).filter(k => dists[k] === min);
const farthest =Object.keys(dists).filter(k => dists[k] === max);

console.log( `最遠${farthest.join("、")} ; 最近${nearest.join("、")}`);
    
}

    
func1("辛巴");
func1("悟空");
func1("弗利沙");
func1("特南克斯");
        

    </script>
</body>
</html>


<!-- 作業二 -->

 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>work-2 作業二</title>
</head>
<body>
    <script>
        const services = [
            { name: "S1", r: 4.5, c: 1000 },
            { name: "S2", r: 3, c: 1200},
            { name: "S3", r: 3.8, c: 800}
        ];

        function func2(ss, start, end, criteria) {
            if (!func2.schedule) {
                func2.schedule = {};
                ss.forEach(s => func2.schedule[s.name] = []);
            }

            let field = null, op = null, value = null;
            for(const o of ["<=", ">=", "="]) {
                if (criteria. includes(o)) {
                    [field, value ] = criteria.split(o);
                    op = o ;
                    field = field.trim();
                    value = value.trim();
                    break;
                }
            }
        

            const available = [];
        
            for(const s of ss) {
                const conflict = func2.schedule[s.name].some(([st, et]) => !(end <= st || start >= et));
                if (conflict) continue;

                if(field === "name") {
                    if(op === "=" && s.name === value) {
                        available.push(s);
                    }
                } else {
                  const val = parseFloat(value);
                  if (op === ">=" && s[field] >= val) {
                    available.push(s);
                  } else if (op === "<=" && s[field] <= val) {
                    available.push(s);
                  } else if (op === "=" && s[field] === val) {
                    available.push(s);
                  }
                }
            }

            if  (available.length === 0) {
                console.log("Sorry");
                return;
            }

            let chosen = null;
            if (field !=="name") {
                const val = parseFloat(value);
                chosen = available.reduce((a, b) => Math.abs(a[field] - val) < Math.abs(b[field] - val) ? a:b);
            } else {
                chosen = available[0];
            }

            func2.schedule[chosen.name].push ([start, end]);
            console.log(chosen.name);
         }

    func2(services, 15, 17, "c>=800" )
    func2(services, 11, 13, "r<=4" )
    func2(services, 10, 12, "name=S3" )
    func2(services, 15, 18, "r>=4.5" )
    func2(services, 16, 18, "r>=4" )
    func2(services, 13, 17, "name=S1" )
    func2(services, 8, 9, "c<=1500" )


    </script>
</body>
</html>


<!-- 作業三 -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>作業三</title>
</head>
<body>
    <script>
        function func3(index){
            const y=[-2, -3, +1, +2];
            let n=25
            for(let x=1 ; x<=index ; x++ ){  // x++= (x=x+1)
                z = y[( x - 1 ) % 4]  
                n= n + z
            }
            console.log(n)
        }

        func3(1)
        func3(5)
        func3(10)
        func3(30)

    </script>
    
</body>
</html>


<!-- 作業四 -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>work-4 作業四</title>
</head>
<body>
    <script>
        function func4(sp, stat, n){
            let candidates=[];
            for(let i=0; i< sp.length; i++){
                if (stat[i] === '0') {
                    candidates.push([i, sp[i]]);
                } //只看可服務的車廂
            }         
        
    
            let enough = candidates.filter(([i, s]) => s >= n);

            let idx;
            if (enough.length > 0) {
                idx = enough.reduce((a,b) => (a[1] <= b[1]? a:b))[0];
            //   選座位數最小的那一個
            } else {
                idx = candidates.reduce((a,b) => (a[1] >= b[1] ? a:b))[0];
                //  選座位數最小的那一個(剛好夠)
            }

            return idx;
        }   
console.log (func4([3, 1, 5, 4, 3, 2], "101000", 2))
console.log (func4([1, 0, 5, 1, 3], "10100", 2))
console.log (func4([4, 6, 5, 8], "1000", 4))
    
    </script>
</body>
</html>